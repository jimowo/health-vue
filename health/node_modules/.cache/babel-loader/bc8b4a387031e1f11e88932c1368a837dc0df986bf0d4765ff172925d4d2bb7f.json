{"ast":null,"code":"import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport Login from \"@/views/login\";\nimport Home from \"@/views/home\";\nimport welcome from \"@/views/welcome\";\nimport store from \"@/store\";\nimport ajax from \"@/utils/ajax\";\nimport { formatMenu } from \"@/utils/initMenus\";\nVue.use(VueRouter);\nconst routes = [{\n  path: \"/login\",\n  name: \"login\",\n  component: Login\n}, {\n  path: \"/home\",\n  name: \"home\",\n  component: Home,\n  children: [{\n    path: \"/home/welcome\",\n    component: welcome\n  }, {\n    path: \"/system/role\",\n    component: welcome\n  }, {\n    path: \"/system/user\",\n    component: welcome\n  }, {\n    path: \"/system/permission\",\n    component: welcome\n  }, {\n    path: \"/system/menu\",\n    component: welcome\n  }]\n}];\nconst router = new VueRouter({\n  routes\n});\n\n/**\n * 路由导航\n * to； 将要去哪个页面\n * from：从哪个页面过来\n * next: 放行到哪个页面\n */\nrouter.beforeEach((to, from, next) => {\n  // 用户是否登录\n  const token = sessionStorage.getItem(\"token\");\n  if (!token) {\n    if (to.path === \"/login\") {\n      next();\n    }\n    next(\"/login\");\n  } else {\n    if (to.path === \"/\") {\n      next(\"/home\");\n    }\n    // 判断vuex 中是否存在用户基本信息\n    // 向后端发送请求 获取用户的基本信息\n    ajax.get(\"/user/getInfo\").then(res => {\n      // 把用户信息复制到本地缓存\n      const user = res.data;\n      store.commit(\"setAvatar\", user.avatar);\n      store.commit(\"setUsername\", user.username);\n      if (user.roles.length > 0) {\n        //添加角色 菜单 权限等信息\n        store.commit(\"setRoles\", user.roles);\n        store.commit(\"setMenus\", user.menus);\n        store.commit(\"setPermissions\", user.permissions);\n      }\n    });\n    next();\n  }\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","Login","Home","welcome","store","ajax","formatMenu","use","routes","path","name","component","children","router","beforeEach","to","from","next","token","sessionStorage","getItem","get","then","res","user","data","commit","avatar","username","roles","length","menus","permissions"],"sources":["C:/Users/12524/Documents/health-vue/health/src/router/index.js"],"sourcesContent":["import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport Login from \"@/views/login\";\nimport Home from \"@/views/home\"\nimport welcome from \"@/views/welcome\";\nimport store from \"@/store\";\nimport ajax from \"@/utils/ajax\";\nimport { formatMenu } from \"@/utils/initMenus\";\n\nVue.use(VueRouter);\n\nconst routes = [\n  {\n    path: \"/login\",\n    name: \"login\",\n    component: Login,\n  },\n  {\n    path: \"/home\",\n    name: \"home\",\n    component: Home,\n    children: [\n      {\n        path: \"/home/welcome\",\n        component: welcome,\n      },\n      {\n        path: \"/system/role\",\n        component: welcome,\n      },\n      {\n        path: \"/system/user\",\n        component: welcome,\n      },\n      {\n        path: \"/system/permission\",\n        component: welcome,\n      },\n      {\n        path: \"/system/menu\",\n        component: welcome,\n      },\n    ]\n  }\n];\n\nconst router = new VueRouter({\n  routes,\n});\n\n/**\n * 路由导航\n * to； 将要去哪个页面\n * from：从哪个页面过来\n * next: 放行到哪个页面\n */\nrouter.beforeEach((to, from, next) => {\n  // 用户是否登录\n  const token = sessionStorage.getItem(\"token\");\n  if (!token) {\n    if (to.path === \"/login\") {\n      next();\n    }\n    next(\"/login\");\n  } else {\n    if (to.path === \"/\") {\n      next(\"/home\")\n    }\n    // 判断vuex 中是否存在用户基本信息\n    // 向后端发送请求 获取用户的基本信息\n    ajax.get(\"/user/getInfo\").then((res) => {\n      // 把用户信息复制到本地缓存\n      const user = res.data;\n      store.commit(\"setAvatar\", user.avatar);\n      store.commit(\"setUsername\", user.username);\n      if (user.roles.length > 0) {\n        //添加角色 菜单 权限等信息\n        store.commit(\"setRoles\", user.roles)\n        \n        store.commit(\"setMenus\", user.menus)\n        store.commit(\"setPermissions\", user.permissions)\n      }\n    });\n    next();\n  }\n});\n\nexport default router;\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,KAAK,MAAM,eAAe;AACjC,OAAOC,IAAI,MAAM,cAAc;AAC/B,OAAOC,OAAO,MAAM,iBAAiB;AACrC,OAAOC,KAAK,MAAM,SAAS;AAC3B,OAAOC,IAAI,MAAM,cAAc;AAC/B,SAASC,UAAU,QAAQ,mBAAmB;AAE9CP,GAAG,CAACQ,GAAG,CAACP,SAAS,CAAC;AAElB,MAAMQ,MAAM,GAAG,CACb;EACEC,IAAI,EAAE,QAAQ;EACdC,IAAI,EAAE,OAAO;EACbC,SAAS,EAAEV;AACb,CAAC,EACD;EACEQ,IAAI,EAAE,OAAO;EACbC,IAAI,EAAE,MAAM;EACZC,SAAS,EAAET,IAAI;EACfU,QAAQ,EAAE,CACR;IACEH,IAAI,EAAE,eAAe;IACrBE,SAAS,EAAER;EACb,CAAC,EACD;IACEM,IAAI,EAAE,cAAc;IACpBE,SAAS,EAAER;EACb,CAAC,EACD;IACEM,IAAI,EAAE,cAAc;IACpBE,SAAS,EAAER;EACb,CAAC,EACD;IACEM,IAAI,EAAE,oBAAoB;IAC1BE,SAAS,EAAER;EACb,CAAC,EACD;IACEM,IAAI,EAAE,cAAc;IACpBE,SAAS,EAAER;EACb,CAAC;AAEL,CAAC,CACF;AAED,MAAMU,MAAM,GAAG,IAAIb,SAAS,CAAC;EAC3BQ;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACAK,MAAM,CAACC,UAAU,CAAC,CAACC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EACpC;EACA,MAAMC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;EAC7C,IAAI,CAACF,KAAK,EAAE;IACV,IAAIH,EAAE,CAACN,IAAI,KAAK,QAAQ,EAAE;MACxBQ,IAAI,EAAE;IACR;IACAA,IAAI,CAAC,QAAQ,CAAC;EAChB,CAAC,MAAM;IACL,IAAIF,EAAE,CAACN,IAAI,KAAK,GAAG,EAAE;MACnBQ,IAAI,CAAC,OAAO,CAAC;IACf;IACA;IACA;IACAZ,IAAI,CAACgB,GAAG,CAAC,eAAe,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;MACtC;MACA,MAAMC,IAAI,GAAGD,GAAG,CAACE,IAAI;MACrBrB,KAAK,CAACsB,MAAM,CAAC,WAAW,EAAEF,IAAI,CAACG,MAAM,CAAC;MACtCvB,KAAK,CAACsB,MAAM,CAAC,aAAa,EAAEF,IAAI,CAACI,QAAQ,CAAC;MAC1C,IAAIJ,IAAI,CAACK,KAAK,CAACC,MAAM,GAAG,CAAC,EAAE;QACzB;QACA1B,KAAK,CAACsB,MAAM,CAAC,UAAU,EAAEF,IAAI,CAACK,KAAK,CAAC;QAEpCzB,KAAK,CAACsB,MAAM,CAAC,UAAU,EAAEF,IAAI,CAACO,KAAK,CAAC;QACpC3B,KAAK,CAACsB,MAAM,CAAC,gBAAgB,EAAEF,IAAI,CAACQ,WAAW,CAAC;MAClD;IACF,CAAC,CAAC;IACFf,IAAI,EAAE;EACR;AACF,CAAC,CAAC;AAEF,eAAeJ,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}