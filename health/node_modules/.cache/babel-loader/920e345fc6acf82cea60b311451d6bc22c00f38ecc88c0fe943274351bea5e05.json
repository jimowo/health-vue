{"ast":null,"code":"import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport Login from \"@/views/login\";\nimport Home from \"@/views/home\";\nimport store from \"@/store\";\nimport ajax from \"@/utils/ajax\";\nVue.use(VueRouter);\nconst routes = [{\n  path: \"/login\",\n  name: \"login\",\n  component: Login\n}, {\n  path: \"/home\",\n  name: \"home\",\n  component: Home\n}];\nconst router = new VueRouter({\n  routes\n});\n\n/**\n * 路由导航\n * to； 将要去哪个页面\n * from：从哪个页面过来\n * next: 放行到哪个页面\n */\nrouter.beforeEach((to, from, next) => {\n  // 用户是否登录\n  const token = sessionStorage.getItem(\"token\");\n  if (!token) {\n    if (to.path === \"/login\") {\n      next();\n    }\n    next(\"/login\");\n  } else {\n    if (to.path === \"/\") {\n      next(\"/home\");\n    }\n    next();\n    // 判断vuex 中是否存在用户基本信息\n    if (!store.state.roles || store.state.roles.length < 1) {\n      // 向后端发送请求 获取用户的基本信息\n      ajax.get(\"/user/getInfo\").then(res => {\n        // 把用户信息复制到本地缓存\n        const user = res.data.data;\n        store.commit(\"setAvatar\", user.avatar);\n        store.commit(\"setUsername\", user.username);\n        if (user.roles.length > 0) {\n          //TODO: 添加角色 菜单 权限等信息\n          store.commit(\"setRoles\", user.roles);\n        }\n      });\n    }\n  }\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","Login","Home","store","ajax","use","routes","path","name","component","router","beforeEach","to","from","next","token","sessionStorage","getItem","state","roles","length","get","then","res","user","data","commit","avatar","username"],"sources":["C:/Users/12524/Documents/health-vue/health/src/router/index.js"],"sourcesContent":["import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport Login from \"@/views/login\";\nimport Home from \"@/views/home\"\nimport store from \"@/store\";\nimport ajax from \"@/utils/ajax\";\n\nVue.use(VueRouter);\n\nconst routes = [\n  {\n    path: \"/login\",\n    name: \"login\",\n    component: Login,\n  },\n  {\n    path: \"/home\",\n    name: \"home\",\n    component: Home,\n  }\n];\n\nconst router = new VueRouter({\n  routes,\n});\n\n/**\n * 路由导航\n * to； 将要去哪个页面\n * from：从哪个页面过来\n * next: 放行到哪个页面\n */\nrouter.beforeEach((to, from, next) => {\n  // 用户是否登录\n  const token = sessionStorage.getItem(\"token\");\n  if (!token) {\n    if (to.path === \"/login\") {\n      next();\n    }\n    next(\"/login\");\n  } else {\n    if (to.path === \"/\") {\n      next(\"/home\")\n    }\n    next();\n    // 判断vuex 中是否存在用户基本信息\n    if (!store.state.roles || store.state.roles.length < 1) {\n      // 向后端发送请求 获取用户的基本信息\n      ajax.get(\"/user/getInfo\").then((res) => {\n        // 把用户信息复制到本地缓存\n        const user = res.data.data;\n        store.commit(\"setAvatar\", user.avatar);\n        store.commit(\"setUsername\", user.username);\n        if (user.roles.length > 0) {\n          //TODO: 添加角色 菜单 权限等信息\n          store.commit(\"setRoles\", user.roles)\n        }\n      });\n    }\n  }\n});\n\nexport default router;\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,KAAK,MAAM,eAAe;AACjC,OAAOC,IAAI,MAAM,cAAc;AAC/B,OAAOC,KAAK,MAAM,SAAS;AAC3B,OAAOC,IAAI,MAAM,cAAc;AAE/BL,GAAG,CAACM,GAAG,CAACL,SAAS,CAAC;AAElB,MAAMM,MAAM,GAAG,CACb;EACEC,IAAI,EAAE,QAAQ;EACdC,IAAI,EAAE,OAAO;EACbC,SAAS,EAAER;AACb,CAAC,EACD;EACEM,IAAI,EAAE,OAAO;EACbC,IAAI,EAAE,MAAM;EACZC,SAAS,EAAEP;AACb,CAAC,CACF;AAED,MAAMQ,MAAM,GAAG,IAAIV,SAAS,CAAC;EAC3BM;AACF,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACAI,MAAM,CAACC,UAAU,CAAC,CAACC,EAAE,EAAEC,IAAI,EAAEC,IAAI,KAAK;EACpC;EACA,MAAMC,KAAK,GAAGC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;EAC7C,IAAI,CAACF,KAAK,EAAE;IACV,IAAIH,EAAE,CAACL,IAAI,KAAK,QAAQ,EAAE;MACxBO,IAAI,EAAE;IACR;IACAA,IAAI,CAAC,QAAQ,CAAC;EAChB,CAAC,MAAM;IACL,IAAIF,EAAE,CAACL,IAAI,KAAK,GAAG,EAAE;MACnBO,IAAI,CAAC,OAAO,CAAC;IACf;IACAA,IAAI,EAAE;IACN;IACA,IAAI,CAACX,KAAK,CAACe,KAAK,CAACC,KAAK,IAAIhB,KAAK,CAACe,KAAK,CAACC,KAAK,CAACC,MAAM,GAAG,CAAC,EAAE;MACtD;MACAhB,IAAI,CAACiB,GAAG,CAAC,eAAe,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;QACtC;QACA,MAAMC,IAAI,GAAGD,GAAG,CAACE,IAAI,CAACA,IAAI;QAC1BtB,KAAK,CAACuB,MAAM,CAAC,WAAW,EAAEF,IAAI,CAACG,MAAM,CAAC;QACtCxB,KAAK,CAACuB,MAAM,CAAC,aAAa,EAAEF,IAAI,CAACI,QAAQ,CAAC;QAC1C,IAAIJ,IAAI,CAACL,KAAK,CAACC,MAAM,GAAG,CAAC,EAAE;UACzB;UACAjB,KAAK,CAACuB,MAAM,CAAC,UAAU,EAAEF,IAAI,CAACL,KAAK,CAAC;QACtC;MACF,CAAC,CAAC;IACJ;EACF;AACF,CAAC,CAAC;AAEF,eAAeT,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}